<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <title>Control de actividades</title>


</head>

<body>
    <form id="fm" class="border border-light p-5">

        <p class="h4 mb-4 text-center">Ingreso SAP</p>
        <input type="text" id="server" class="form-control mb-4" placeholder="Server" disabled="true">
        <input type="text" id="user" class="form-control mb-4" placeholder="Usuario">
        <input type="password" id="password" class="form-control mb-4" placeholder="Password">
      <!--  <input type="text" id="company" class="form-control mb-4" placeholder="Sociedad"> -->
        <select id="company" name="company" class="form-control mb-4" placeholder="Sociedad">
            <option value="VISUALK_CL" selected>Visual Knowledge Chile S.A.</option>
            <option value="VISUALK_PE_2" >VisualK Negocios S.A.C.</option>
            <option value="VISUALK_PE_FE"> FE VisualK Negocios S.A.C.</option>
            <option value="MASTER_VISUALK_PE_2">zzzz.Master VisualK Negocios S.A.C.</option>
            <option value="TEST_VK_RINDEGASTOS" >TEST  Visual Knowledge Chile S.A.</option>
            <option value="VK_PROCESOS"> Procesos e Innovaci√≥n</option>
            <option value="VISUALK_MKT">VisualK Marketing IntL.</option>
            <option value="SBO_VK_SEMILLA3"> SBO_VK_SEMILLA</option>
            <option value="CIERRE_VISUALK_AR"> CIERRE VK ARGENTINA</option>
            <option value="VISUALK_PE_2012">VisualK Peru (2012)</option>
            <option value="VISUALD_CL_1">Visual Developer Chile S.A.</option>
            <option value="20181126_VK_CL_TEST">** TEST VK Chile **</option>
        </select>

        <button class="btn btn-info btn-block my-4" type="submit" id="btnLogin">Ingresar</button>
    </form>
</body>
<script>
    $(document).ready(function () {
        $("#btnLogin").click(function (e) {
            //alert("button");
            e.preventDefault();
            Login();
        });
        $("#server").val("hanab1vk:30015");
        $("#user").val("asanchez");
        $("#password").val("19045403");
       // $("#company").val("VK_DEMO");
    });

    function Login() {
        $("#btnLogin").prop("disabled", true);
        json = { "user": $("#user").val(), "password": $("#password").val(), "company": $("#company").val() }
        //console.log(json);
        var jsonStr = JSON.stringify(json);
        $.ajax({
            type: 'post',
            dataType: "text",
            contentType: "application/text; charset=utf-8",
            url: 'login',
            async: false,
            timeout: 30,
            data: jsonStr
        }).done(function (result) {
            $("#btnLogin").prop("disabled", false);
            //alert(data);
            var i = 1;
            if (result.startsWith("error:")) {
                alert(result.replace("error:",""));
            } else {
                let json = result.serializeFormJSON;
                console.log(result)
                console.log(json)
                alert("Cookie: " + result);
                
                window.location.href = 'Home.html';
            }
        });
    }
</script>

</html>